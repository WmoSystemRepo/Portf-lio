<div class="app-container">
  <!-- Cabeçalho com ações -->
  <div class="header">
    <button class="tour-button" (click)="monitorarAnyPointStoreViaSwagger()" type="button">
      <i class="fas fa-sync"></i> Recarregar
    </button>
    <h2 class="title">Monitor de APIs AnyPoint</h2>
    <button class="tour-button" (click)="clearFilters()" type="button">
      <i class="fas fa-filter"></i> Limpar filtros
    </button>
  </div>

  <!-- Tabela com filtros e dados -->
  <div class="table-wrapper">
    <div class="crud-table">
      <!-- Linha de filtros -->
      <div class="crud-table-header filters-row">
        <ng-container *ngFor="let field of fields">
          <div class="crud-col" *ngIf="isFieldVisible(field.name)">
            <input
              class="column-filter-input"
              [type]="isDateField(field.name) ? 'date' : 'text'"
              [(ngModel)]="columnFilters[field.name]"
              [placeholder]="field.label"
            />
          </div>
        </ng-container>
        <div class="crud-col actions-col">Ações</div>
      </div>

      <!-- Linhas da tabela com dados -->
      <div class="crud-table-row" *ngFor="let item of filteredLogs">
        <ng-container *ngFor="let field of fields">
          <div class="crud-col" *ngIf="isFieldVisible(field.name)">
            {{ getFieldValue(item, field.name) }}
          </div>
        </ng-container>
        <div class="crud-col actions-col">
          <button
            class="action-btn config-btn"
            title="Ver Detalhes"
            (click)="openDetailsModal(item)"
          >
            <i class="fas fa-eye"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de detalhes -->
  <div class="app-modal-overlay" *ngIf="isDetailsModalOpen">
    <div class="app-modal-container">
      <div class="modal-header">
        <i class="fas fa-eye"></i>
        <h3 class="modal-title">Detalhes do Endpoint</h3>
      </div>

      <div *ngIf="itemToView">
        <ng-container *ngFor="let field of fields">
          <div
            class="field-visibility-item"
            *ngIf="!isFieldVisible(field.name)"
          >
            <strong>{{ field.label }}:</strong>
            <span>{{ getFieldValue(itemToView, field.name) }}</span>
          </div>
        </ng-container>

        <div *ngIf="visibleFields.length === fields.length" class="no-details-message">
          <i class="fas fa-eye-slash text-red"></i>
          <p>Todos os campos já estão visíveis na tabela.</p>
        </div>
      </div>

      <div class="app-modal-buttons">
        <button class="btn-secondary" (click)="closeDetailsModal()">Fechar</button>
      </div>
    </div>
  </div>
</div>
