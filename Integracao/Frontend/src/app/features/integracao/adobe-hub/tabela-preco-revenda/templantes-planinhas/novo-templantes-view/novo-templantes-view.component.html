<div class="preview-container app-container">
  <h2>üì¶ Pr√©-visualiza√ß√£o de Template</h2>

  <p class="text-white">
    Clique em uma c√©lula que contenha pelo menos um caractere para marcar o in√≠cio do cabe√ßalho.
  </p>

  <!-- ‚ö†Ô∏è Mensagem de erro -->
  <div *ngIf="invalidCellMessage" class="cell-warning">
    {{ invalidCellMessage }}
  </div>

  <!-- üìä Tabela de dados -->
  <div class="data-grid">
    <table class="preview-table">
      <thead>
        <tr>
          <th>#</th>
          <th *ngFor="let col of data[0]; let colIndex = index">
            {{ getColumnLetter(colIndex) }}
          </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of data; let rowIndex = index">
          <td class="row-index">{{ rowIndex + 1 }}</td>
          <td
            *ngFor="let cell of row; let colIndex = index"
            [class.selected]="isSelected(rowIndex, colIndex)"
            [class.invalid]="isInvalidCell(rowIndex, colIndex)"
            [class.merged]="isMergedCell(rowIndex, colIndex)"
            (click)="selectCell(rowIndex, colIndex)"
          >
            {{ cell }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- üîò A√ß√µes -->
  <div class="preview-actions">
    <button class="btn-secondary" (click)="goBack()">‚¨Ö Voltar</button>
    <button
      class="btn-primary"
      [disabled]="selectedRow === null || selectedCol === null || !!invalidCellMessage"
      (click)="proceedToCreate()"
    >
      ‚úÖ Confirmar cabe√ßalho em {{ getColumnLetter(selectedCol!) }}{{ selectedRow! + 1 }}
    </button>
  </div>
</div>
